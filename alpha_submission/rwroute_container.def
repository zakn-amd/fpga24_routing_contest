BootStrap: docker
From: eclipse-temurin:17 # Base image fulfills Java dependencies

%files
	# Copy the list of Python dependencies into the container so that they
	# are available during the configuration phase
	./requirements.txt /requirements.txt

%post
	# Install remaining system dependencies
	apt-get -y update
	apt-get -y install git python3 pip pkg-config libcapnp-dev time libtinfo5
	pip install -r /requirements.txt
	# Create a mount point for Vivado
	mkdir /tools

%environment
	# Add the host Vivado to the path
	export PATH=$PATH:/tools/Xilinx/Vivado/2022.2/bin/

%runscript
	# Run the Makefile with the ROUTER variable set to the first argument
	# passed to the container
	make ROUTER=$1
